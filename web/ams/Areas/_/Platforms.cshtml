@using jqx
@using ams
@using ams.Controllers;
@{
    ViewBag.Title = "Platforms";
    ViewBag.PanelBody = widgets.tran_size;
    jqxGrid grid = new jqxGrid<ams.Data.PlatformInfo> {
        page = this,
        scope_id = "grid1",
        source = { id = "ID", url = Url.GetActionUrl<PlatformsApiController>("list"), },
        pager = { pageable = true, server_paging = true, pagermode = pagermode.simple },
        filter = { filterable = true, server_filtering = true, showfilterrow = false, showfiltermenuitems = false, },
        sorting = { sortable = true, server_sorting = true, },
        showtoolbar = false,
        editmode = editmode.selectedcell,
        selectionmode = selectionmode.singlerow,
        selectedrowindex = 0,
        columns = new[] {
            new jqxGrid._column { _datafield = { name = "ID          ", type = dataFieldType._number }, text = lang["Platform ID  "], width = 100 },
            new jqxGrid._column { _datafield = { name = "ver         ", type = dataFieldType._number }, text = lang["ver          "], width = 100, hidden = true },
            new jqxGrid._column { _datafield = { name = "PlatformName", type = dataFieldType._string }, text = lang["Platform Name"], width = 100 },
            new jqxGrid._column { _datafield = { name = "PlatformType", type = dataFieldType._string }, text = lang["Platform Type"], width = 100 },
            new jqxGrid._column { _datafield = { name = "Currency    ", type = dataFieldType._string }, text = lang["Currency     "], width = 100 },
            new jqxGrid._column { _datafield = { name = "Active      ", type = dataFieldType._string }, text = lang["State        "], width = 100 },
            new jqxGrid._columns.DateTime { _datafield = { name = "CreateTime   " }, text = lang["CreateTime    "] },
            new jqxGrid._columns.User____ { _datafield = { name = "CreateUser   " }, text = lang["CreateUser    "] },
            new jqxGrid._columns.DateTime { _datafield = { name = "ModifyTime   " }, text = lang["ModifyTime    "] },
            new jqxGrid._columns.User____ { _datafield = { name = "ModifyUser   " }, text = lang["ModifyUser    "] },
        }
    };
    widgets.layout_grid_detail(this, grid);
}
@section head {
    <script type="text/javascript">
        $(document).on('ng-app-init', function (e, $scope, $compile, $http) {
            window.$grid1 = $scope['@grid.scope_id'] = $('#_grid1').jqxGridEx($.n(@grid), {
                $scope: $scope,
                ext: {
                    grps: {
                        '': {
                            OnUpdate: function (rowid, rowdata, data, jqXHR, settings) {
                                settings.url = '@(Url.GetActionUrl<PlatformsApiController>("set"))';
                            },
                        },
                        'aaa': {
                            OnUpdate: function (rowid, rowdata, data, jqXHR, settings) {
                            },
                            OnLoading: function (rowid, rowdata, jqXHR, settings) {
                            },
                        },
                        'bbb': {}
                    },
                    OnAddingRow: function (addRow) {
                        for (var id = 1, id_max = '@int.MaxValue'; id < id_max; id++) {
                            var row = this.getrowdatabyid(id);
                            if (row == null) {
                                addRow(id, {
                                    PlatformType: '@PlatformType.InnateGloryA',
                                    PlatformName: '',
                                    Active: '@PlatformActiveState.Disabled',
                                    Currency: '@CurrencyCode.TWD'
                                });
                                return;
                            }
                        }
                    },
                    OnAddRow: function (data, jqXHR, settings) {
                        settings.url = '@(Url.GetActionUrl<PlatformsApiController>("add"))';
                    },
                },
                event: {
                    //'*': function (event) { console.log(event.type, event); },
                    bindingcomplete: function (event) {
                        //event.owner.selectrow(0)
                    },
                },
            });
        });
    </script>
}
@section toolbar {
    @toolbars.GridAdd(grid)
    @toolbars.GridRefresh(grid)
}
@section add_form {
    <section class="container-fluid form-horizontal">
        <div class="row">
            <div class="col-sm-6">
                <div class="panel panel-default">
                    <div class="panel-heading"><h3 class="panel-title">General</h3></div>
                    <div class="panel-body">
                        @widgets.NumberInput("   ", grid, "ID          ", addonly: true, min: 1)
                        @widgets.PlatformType("  ", grid, "PlatformType", addonly: true)
                        @widgets.TextInput("     ", grid, "PlatformName", addonly: true)
                        @widgets.Currency("      ", grid, "Currency    ", addonly: true)
                        @widgets.PlatformActive("", grid, "Active      ", addonly: true)
                        @widgets.CommandsAdd(grid)
                    </div>
                </div>
            </div>
            <div class="col-sm-6 hidden">
                <div class="panel panel-default">
                    <div class="panel-heading"><h3 class="panel-title"></h3></div>
                    <div class="panel-body">
                    </div>
                </div>
            </div>
        </div>
        <div class="row hidden">
            <div class="col-sm-6">
                <div class="panel panel-default">
                    <div class="panel-body">
                    </div>
                </div>
            </div>
        </div>
    </section>
}
@section edit_form {
    <section class="container-fluid form-horizontal">
        <ul class="nav nav-pills">
            <li class="active"><a href="" data-toggle="tab" data-target=".tab1">@lang["General"]</a></li>
            <li class="hidden"><a href="" data-toggle="tab" data-target=".tab2">@lang["Config"]</a></li>
            <li class="hidden"><a href="" data-toggle="tab" data-target=".tab3">@lang["Agent Settings"]</a></li>
            <li class="hidden"><a href="" data-toggle="tab" data-target=".tab4">@lang["Admin Settings"]</a></li>
            <li class="hidden"><a href="" data-toggle="tab" data-target=".tab5">@lang["Member Settings"]</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab1 row tab-pane fade in active">
                <div class="col-sm-6">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            @widgets.TextBox("       ", grid, "ID          ")
                            @widgets.TextBox("       ", grid, "PlatformType")
                            @widgets.TextBox("       ", grid, "PlatformName")
                            @widgets.TextBox("       ", grid, "Currency    ", width: 4)
                            @widgets.PlatformActive("", grid, "Active      ")
                            @widgets.CommandsEdit(grid)
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 hidden">
                    <div class="panel panel-default">
                        <div class="panel-body">
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab2 row tab-pane fade"><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">2</div></div></div><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">2</div></div></div></div>
            <div class="tab3 row tab-pane fade"><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">3</div></div></div><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">3</div></div></div></div>
            <div class="tab4 row tab-pane fade"><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">4</div></div></div><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">4</div></div></div></div>
            <div class="tab5 row tab-pane fade"><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">5</div></div></div><div class="col-sm-6"><div class="panel panel-default"><div class="panel-body">5</div></div></div></div>
        </div>
    </section>
}
<div id="_grid1"></div>